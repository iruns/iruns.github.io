import{p as Z,s as ee,b as se,d as Q,c as b,e as V,f as te,r as ae}from"./index-bddbf4d6.js";import{e as G,f as o,o as f,a as p,d as r,h as k,g as l,w as C,a5 as j,a4 as E,F as N,q as R,l as L,t as $,u as ne,r as P,m as z,a2 as oe,n as F,k as re,i as le,P as ce,p as ie,b as ue,_ as he}from"./progress-7b0ac2aa.js";import{S as fe,_ as de}from"./PageContainer.vue_vue_type_style_index_0_lang-73167ad4.js";const pe=""+new URL("persona-answers-5f4217e2.webp",import.meta.url).href,ve={class:"question-sign"},Se=r("p",{class:"instruction"}," Lihat pertanyaan di bentuk ini ",-1),_e={class:"shape"},ge={class:"answers"},me=r("img",{class:"circles",src:pe},null,-1),we={class:"texts"},xe=["onClick"],ye=G({__name:"PersonaStepSet",props:{historyStep:null,idxOffset:{default:0},stepState:{default:"question"},onNext:{type:Function,default:()=>{}},onSelect:null,isLast:{type:Boolean,default:!1}},setup(n){const B=n,i=o(()=>Z[B.historyStep.answerSet.question]),x=o(()=>ee([...B.historyStep.answerSet.answers]));return(u,M)=>(f(),p("div",{class:L(["step-set",n.idxOffset?n.idxOffset==1?"next-1 question-state":n.idxOffset==-1?"prev-1 answers-state":!1:"active "+n.stepState+"-state",n.isLast?"last":""])},[r("div",ve,[Se,r("div",_e,[k(fe,{src:"persona-shapes.webp","x-sprites":2,"y-sprites":3,x:l(i).x,y:l(i).y},null,8,["x","y"])]),k(E,{class:"cta",onClick:n.onNext},{default:C(()=>[j(" Lanjut ")]),_:1},8,["onClick"])]),r("div",ge,[me,r("div",we,[(f(!0),p(N,null,R(l(x),(c,v)=>(f(),p("div",{key:v,class:L(["answer",v%2==0?"even":"odd"])},[r("p",{onClick:S=>n.onSelect(c)},$(c.text),9,xe)],2))),128))])])],2))}});const Ae=n=>(ie("data-v-17646a1d"),n=n(),ue(),n),Pe={class:"persona-answers"},ke={class:"number current"},Be={class:"current"},qe={class:"all"},be=Ae(()=>r("p",{class:"instruction"},"Selesai di Ruang Terang",-1)),Ce=G({__name:"PersonaAnswersPage",setup(n){const i=se(),x=ne(),u=P(i.progress.personaHistory),M=o(()=>{const e={};return u.value.map(a=>e[a.answerSet.id]=!0),e}),c=o(()=>u.value.length),v=o(()=>u.value[c.value-1]||null),S=P("question"),_=o(()=>S.value=="question"&&c.value==b+1),y=o(()=>{let e=0,a=V[e];for(;c.value>a.until;)e++,a=V[e];return a}),I=o(()=>i.progress.personaScoresSum),g=P([]);for(let e=0;e<Q.length;e++){const a=Q[e].id;g.value.push({arch:a,score:I.value[a]||0,idx:e})}const m=o(()=>{const e=y.value.focusBetween;for(let s=0;s<g.value.length;s++){const t=g.value[s];t.score=I.value[t.arch]||0}const a=[...g.value];return a.sort((s,t)=>s.score==t.score?Math.random()-.5:s.score>t.score?-1:1),a.slice(0,e)}),H=o(()=>{let e=0;const a=m.value;for(let s=0;s<a.length;s++){const t=a[s];e+=t.score}return e/=a.length,a.filter(s=>s.score<e).sort((s,t)=>s.idx<t.idx?-1:1)}),w=o(()=>(m.value.length==g.value.length,te.filter(a=>!(a.question==U.value||M.value[a.id])))),d=P([]);function D(){d.value=[...w.value],y.value.contrastMult&&(y.value.contrastMult>0?d.value.sort((s,t)=>s.contrast<t.contrast?1:-1):y.value.contrastMult<0&&d.value.sort((s,t)=>s.contrast>t.contrast?1:-1));for(let s=0;s<w.value.length;s++){const t=w.value[s];t.fitness=0;for(let h=0;h<m.value.length;h++){const A=m.value[h];t.fitness+=(t.sumScores[A.arch]||0)*-A.score}}d.value.sort((s,t)=>s.fitness>t.fitness?-1:1);const e=H.value.length>1?H.value:m.value;if(e.length>1){for(let s=0;s<w.value.length;s++){const t=w.value[s];if(t.fitness=0,e.length)for(let h=0;h<e.length;h++){const A=e[h].arch,O=t.contrasts[A];if(O)for(let q=0;q<e.length;q++){const X=e[q].arch;t.fitness+=O[X]||0}}}d.value.sort((s,t)=>s.fitness>t.fitness?-1:1)}const a=d.value[0];a&&i.addPersonaStep({answerSet:a})}const U=o(()=>u.value.length?u.value[u.value.length-1].answerSet.question:null),Y=o(()=>!_.value&&(!v.value||!!v.value.selectedScores));z(Y,(e,a)=>{e!=a&&e&&D()},{immediate:!0});function J(){S.value="answers"}function K(e){i.selectPersonaAnswer(e.scores),S.value="question"}function W(){i.selectPersona(),ae.replace({name:ce.PersonaToNextArea})}z(_,(e,a)=>{e!=a&&T()},{immediate:!0}),oe(()=>T(!0));function T(e=!1){_.value?setTimeout(()=>{x.setBGSetting({logoSize:.5,headerY:.5})},e?0:800):x.setBGSetting({})}return(e,a)=>(f(),p("div",Pe,[r("div",{class:"steps-container",style:F({top:"-"+(l(c)-1)*1.5*100+"vh"})},[(f(!0),p(N,null,R(l(i).progress.personaHistory,(s,t)=>(f(),p(N,null,[Math.abs(l(c)-(t+1))<=1?(f(),re(ye,{key:t,"history-step":s,"idx-offset":t-l(c)+1,"step-state":S.value,"on-next":J,"on-select":K,"is-last":l(_),style:F({top:t*1.5*100+"vh"})},null,8,["history-step","idx-offset","step-state","is-last","style"])):le("",!0)],64))),256))],4),r("div",{class:L(["others",{last:l(_)}])},[r("div",ke,[r("span",Be,$(Math.min(l(c),l(b))),1),r("span",qe,"/"+$(l(b)),1)]),k(de,{"outer-class":{closing:!0}},{default:C(()=>[be,k(E,{class:"cta",onClick:W},{default:C(()=>[j(" Lanjut ")]),_:1})]),_:1})],2)]))}});const Me=he(Ce,[["__scopeId","data-v-17646a1d"]]);export{Me as default};
