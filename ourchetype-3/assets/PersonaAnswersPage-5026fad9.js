import{d as z,f as i,a4 as X,o as p,c as v,b as r,g as M,u as c,w as L,Y as E,Z as F,F as $,s as G,j as H,t as k,e as T,r as C,l as Q,W as ee,n as P,m as te,h as se,p as ae,a as ne,V as re,_ as oe}from"./base-a4493cd8.js";import{r as d}from"./index-72268a61.js";import{S as ce,_ as le}from"./PageContainer.vue_vue_type_style_index_0_lang-3904b936.js";import{a as ie}from"./personaAnswerSets-ac915f33.js";import{a as R}from"./archetypes-092167bb.js";import"./images-5702e0d1.js";import"./archetype-82cba3d4.js";var h=(a=>(a[a.Biasanya=0]="Biasanya",a[a.Penting=1]="Penting",a[a.Menyenangkan=2]="Menyenangkan",a[a.Krisis=3]="Krisis",a[a.TidakDitolerir=4]="TidakDitolerir",a))(h||{});const ue=[{type:h.Biasanya,x:0,y:0},{type:h.Penting,x:1,y:0},{type:h.Menyenangkan,x:0,y:1},{type:h.Krisis,x:1,y:1},{type:h.TidakDitolerir,x:0,y:2}],K={};ue.forEach(a=>K[a.type]=a);const j=[{until:5,focusBetween:12,contrastMult:-1},{until:8,focusBetween:6,contrastMult:0},{until:1/0,focusBetween:3,contrastMult:1}],q=10,pe=""+new URL("persona-answers-5f4217e2.webp",import.meta.url).href,fe={class:"question-sign"},de=r("p",{class:"instruction"},k(`Lihat pertanyaan
di bentuk ini`),-1),he={class:"shape"},ve={class:"answers"},Se=r("img",{class:"circles",src:pe},null,-1),ge={class:"texts"},me=["onClick"],_e=z({__name:"PersonaStepSet",props:{historyStep:null,idxOffset:{default:0},stepState:{default:"question"},onNext:{type:Function,default:()=>{}},onSelect:null,isLast:{type:Boolean,default:!1}},setup(a){const S=a,g=i(()=>K[S.historyStep.answerSet.question]),l=i(()=>X([...S.historyStep.answerSet.answers]));return(o,m)=>(p(),v("div",{class:H(["step-set",a.idxOffset?a.idxOffset==1?"next-1 question-state":a.idxOffset==-1?"prev-1 answers-state":!1:"active "+a.stepState+"-state",a.isLast?"last":""])},[r("div",fe,[de,r("div",he,[M(ce,{src:"persona-shapes.webp","x-sprites":2,"y-sprites":3,x:c(g).x,y:c(g).y},null,8,["x","y"])]),M(F,{class:"cta",onClick:a.onNext},{default:L(()=>[E(" Lanjut ")]),_:1},8,["onClick"])]),r("div",ve,[Se,r("div",ge,[(p(!0),v($,null,G(c(l),(A,B)=>(p(),v("div",{key:B,class:H(["answer",B%2==0?"even":"odd"])},[r("p",{onClick:_=>a.onSelect(A)},k(A.text),9,me)],2))),128))])])],2))}});const xe=a=>(ae("data-v-4d6036f2"),a=a(),ne(),a),ye={class:"persona-answers"},we={class:"number current"},ke={class:"current"},Ae={class:"all"},Be=xe(()=>r("p",{class:"instruction"},k(`Selesai di
Ruang Terang`),-1)),Ie=z({__name:"PersonaAnswersPage",props:{stepIdx:{default:"0"},stepState:{default:"question"}},setup(a){const S=a,g=1.5,l=i(()=>Number.parseInt(S.stepIdx)),o=T(),m=C(o.progress.personaHistory),A=i(()=>m.value.map(s=>s.answerSet)),B=i(()=>m.value.length?m.value[m.value.length-1].answerSet.question:null),_=i(()=>{let s=0,n=j[s];for(;l.value>n.until;)s++,n=j[s];return n}),V=i(()=>o.progress.personaScoresSum),x=C([]);for(let s=0;s<R.length;s++){const n=R[s].id;x.value.push({arch:n,score:V.value[n]||0,idx:s})}const y=i(()=>{const s=_.value.focusBetween;for(let e=0;e<x.value.length;e++){const t=x.value[e];t.score=V.value[t.arch]||0}const n=[...x.value];return n.sort((e,t)=>e.score==t.score?Math.random()-.5:e.score>t.score?-1:1),n.slice(0,s)}),D=i(()=>{let s=0;const n=y.value;for(let e=0;e<n.length;e++){const t=n[e];s+=t.score}return s/=n.length,n.filter(e=>e.score<s).sort((e,t)=>e.idx<t.idx?-1:1)}),w=i(()=>(y.value.length==x.value.length,ie.filter(n=>!(n.question==B.value||A.value.includes(n))))),f=C([]);function Y(){f.value=[...w.value],_.value.contrastMult&&(_.value.contrastMult>0?f.value.sort((e,t)=>e.contrast<t.contrast?1:-1):_.value.contrastMult<0&&f.value.sort((e,t)=>e.contrast>t.contrast?1:-1));for(let e=0;e<w.value.length;e++){const t=w.value[e];t.fitness=0;for(let u=0;u<y.value.length;u++){const I=y.value[u];t.fitness+=(t.sumScores[I.arch]||0)*-I.score}}f.value.sort((e,t)=>e.fitness>t.fitness?-1:1);const s=D.value.length>1?D.value:y.value;if(s.length>1){for(let e=0;e<w.value.length;e++){const t=w.value[e];if(t.fitness=0,s.length)for(let u=0;u<s.length;u++){const I=s[u].arch,O=t.contrasts[I];if(O)for(let N=0;N<s.length;N++){const J=s[N].arch;t.fitness+=O[J]||0}}}f.value.sort((e,t)=>e.fitness>t.fitness?-1:1)}const n=f.value[0];n&&o.addPersonaStep({answerSet:n})}const b=i(()=>l.value==q+1);function U(){d.push({name:"area-1-answers",params:{stepIdx:l.value,stepState:"answers"}})}function W(s){o.selectPersonaAnswer(s.scores),d.push({name:"area-1-answers",params:{stepIdx:l.value+1,stepState:"question"}})}function Z(){d.push({name:"area-1-to-next-area"})}return Q(d.currentRoute,()=>{d.currentRoute.value.name==="area-1-answers"&&re(()=>{const s=l.value,n=o.progress.personaHistory.length;if(s>n){const e=o.progress.personaHistory[n-1],t=!e||!!e.selectedScores;t&&Y(),d.replace({name:"area-1-answers",params:{stepIdx:n+(t?1:0),stepState:"question"}})}else s<n&&(o.progress.personaHistory.length=s);S.stepState=="question"&&b.value?setTimeout(()=>{o.setBGSetting({logoSize:.5,headerY:.5})},500):o.setBGSetting({})})},{immediate:!0}),ee(()=>o.setBGSetting({})),(s,n)=>(p(),v("div",ye,[r("div",{class:"steps-container",style:P({top:"-"+(c(l)-1)*g*100+"vh"})},[(p(!0),v($,null,G(c(o).progress.personaHistory,(e,t)=>(p(),v($,null,[Math.abs(c(l)-(t+1))<=1?(p(),te(_e,{key:t,"history-step":e,"idx-offset":t-c(l)+1,"step-state":a.stepState,"on-next":U,"on-select":W,"is-last":c(b),style:P({top:t*g*100+"vh"})},null,8,["history-step","idx-offset","step-state","is-last","style"])):se("",!0)],64))),256))],4),r("div",{class:H(["others",{last:c(b)}])},[r("div",we,[r("span",ke,k(Math.min(c(l),c(q))),1),r("span",Ae,"/"+k(c(q)),1)]),M(le,{"outer-class":{closing:!0}},{default:L(()=>[Be,M(F,{class:"cta",onClick:Z},{default:L(()=>[E(" Lanjut ")]),_:1})]),_:1})],2)]))}});const He=oe(Ie,[["__scopeId","data-v-4d6036f2"]]);export{He as default};
